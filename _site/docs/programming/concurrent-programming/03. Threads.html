<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li:not(:nth-child(3)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(2) > ul > li:nth-child(3) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(2) > ul > li:nth-child(3) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(3) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Threads | sanhan research</title> <meta name="generator" content="Jekyll v3.10.0" /> <meta property="og:title" content="Threads" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Lesson 5" /> <meta property="og:description" content="Lesson 5" /> <link rel="canonical" href="http://localhost:4000/docs/programming/concurrent-programming/03.%20Threads.html" /> <meta property="og:url" content="http://localhost:4000/docs/programming/concurrent-programming/03.%20Threads.html" /> <meta property="og:site_name" content="sanhan research" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Threads" /> <meta name="google-site-verification" content="TumEYHq6xpSNuebLNUkEWUMOUm3w7a6mdrQ33DQPEwA" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Lesson 5","headline":"Threads","url":"http://localhost:4000/docs/programming/concurrent-programming/03.%20Threads.html"}</script> <!-- End Jekyll SEO tag --> <!-- Automatically display code inside script tags with type=math/tex using MathJax --> <script type="text/javascript" defer src="/assets/js/mathjax-script-type.js"> </script> <!-- Copied from https://docs.mathjax.org/en/latest/web/components/combined.html --> <script type="text/javascript" id="MathJax-script" defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"> </script> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> sanhan research </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Research category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/research" class="nav-list-link">Research</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Computer Vision category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/research/computer-vision" class="nav-list-link">Computer Vision</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/research/computer-vision/3d-image-reconstruction.html" class="nav-list-link">3D Image Reconstruction - Introduction</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in LLM category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/research/llm" class="nav-list-link">LLM</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/research/llm/rag.html" class="nav-list-link">RAG</a></li><li class="nav-list-item"><a href="/docs/research/llm/control_llm.html" class="nav-list-link">Control theory of LLM</a></li></ul></li><li class="nav-list-item"><a href="/docs/research/unlearning" class="nav-list-link">Machine Unlearning</a></li><li class="nav-list-item"><a href="/docs/research/controls" class="nav-list-link">Controls & Robotics</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Programming category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/programming" class="nav-list-link">Programming</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Algorithms and Data structures category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/programming/algorithms.html" class="nav-list-link">Algorithms and Data structures</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/programming/algorithms/Useful%20Timer%20Class.html" class="nav-list-link">Useful Timer Class</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Concurrent Programming category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/programming/concurrent-programming.html" class="nav-list-link">Concurrent Programming</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/programming/concurrent-programming/01.%20Introduction.html" class="nav-list-link">01. Introduction</a></li><li class="nav-list-item"><a href="/docs/programming/concurrent-programming/02.%20Process.html" class="nav-list-link">02. Process</a></li><li class="nav-list-item"><a href="/docs/programming/concurrent-programming/03.%20Threads.html" class="nav-list-link">03. Threads</a></li><li class="nav-list-item"><a href="/docs/programming/concurrent-programming/04.%20Race%20condition.html" class="nav-list-link">04. Race Conditions</a></li></ul></li><li class="nav-list-item"><a href="/docs/programming/cpp.html" class="nav-list-link">C / C++</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Python category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/programming/python.html" class="nav-list-link">Python</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/programming/python/01.%20Typing.html" class="nav-list-link">01. Typing</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Rust category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/programming/rust-programming.html" class="nav-list-link">Rust</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/programming/rust/01.%20Hello,%20World!.html" class="nav-list-link">01. Hello, World!</a></li><li class="nav-list-item"><a href="/docs/programming/rust/02.%20Basic%20Syntax%20in%20Rust.html" class="nav-list-link">02. Basic Syntax in Rust</a></li><li class="nav-list-item"><a href="/docs/programming/rust/03.%20Pointers%20in%20Rust.html" class="nav-list-link">03. Pointers in Rust</a></li></ul></li></ul></li><li class="nav-list-item"><a href="/docs/mathematics" class="nav-list-link">Mathematics</a></li><li class="nav-list-item"><a href="/docs/about.html" class="nav-list-link">About</a></li></ul> <ul class="nav-list"><li class="nav-list-item external"> <a href="https://github.com/Sangdo-Han" class="nav-list-link external" > GitHub <svg viewBox="0 0 24 24" aria-labelledby="svg-external-link-title"><use xlink:href="#svg-external-link"></use></svg> </a> </li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search sanhan research" aria-label="Search sanhan research" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/docs/programming">Programming</a></li> <li class="breadcrumb-nav-list-item"><a href="/docs/programming/concurrent-programming.html">Concurrent Programming</a></li> <li class="breadcrumb-nav-list-item"><span>03. Threads</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="thread"> <a href="#thread" class="anchor-heading" aria-labelledby="thread"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Thread </h1> <p>A thread is indeed an independent sequence of instructions within a process. It’s the smallest unit of execution that can be scheduled by the OS.</p> <details open=""> <summary class="text-delta"> Table of contents </summary> <ul id="markdown-toc"> <li><a href="#thread" id="markdown-toc-thread">Thread</a> <ul> <li><a href="#more-specifically" id="markdown-toc-more-specifically">More specifically</a></li> <li><a href="#advantages-and-disadvantages" id="markdown-toc-advantages-and-disadvantages">Advantages and Disadvantages</a> <ul> <li><a href="#pros---memory--communication-overhead" id="markdown-toc-pros---memory--communication-overhead">Pros - memory / communication overhead</a></li> <li><a href="#cons---developers-burden-on-synchronization" id="markdown-toc-cons---developers-burden-on-synchronization">Cons - developer’s burden on synchronization.</a></li> </ul> </li> <li><a href="#example-of-multi-threading" id="markdown-toc-example-of-multi-threading">Example of Multi-Threading</a> <ul> <li><a href="#multi-threading-in-python" id="markdown-toc-multi-threading-in-python">Multi-Threading in Python</a></li> <li><a href="#multi-threading-in-c" id="markdown-toc-multi-threading-in-c">Multi-Threading in C++</a></li> </ul> </li> </ul> </li> </ul> </details> <h2 id="more-specifically"> <a href="#more-specifically" class="anchor-heading" aria-labelledby="more-specifically"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> More specifically </h2> <p>A thread is the smallest sequence of instructions that can be executed independently. Each thread has its own stack and registers, but it shares the same memory with other threads in the same process. This means threads in a process can access the same data, but they cannot modify each other’s register value without proper synchronization.</p> <p>In short, each thread operates independently, unaware of the others unless explicitly designed to interact.</p> <h2 id="advantages-and-disadvantages"> <a href="#advantages-and-disadvantages" class="anchor-heading" aria-labelledby="advantages-and-disadvantages"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Advantages and Disadvantages </h2> <h3 id="pros---memory--communication-overhead"> <a href="#pros---memory--communication-overhead" class="anchor-heading" aria-labelledby="pros---memory--communication-overhead"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pros - memory / communication overhead </h3> <p>Threads have much less memory overhead than the standard <code class="language-plaintext highlighter-rouge">fork()</code> function as the parent thread is not copied - threads use the same process.</p> <p>Also, by accessing the shared address space of their parent process, all the threads in a process can communicate with the same data: any changes by a single thread is immediately available to the others.</p> <p>In tasks like graphics programming (e.g., shader programming), threads are often more convenient than processes.</p> <h3 id="cons---developers-burden-on-synchronization"> <a href="#cons---developers-burden-on-synchronization" class="anchor-heading" aria-labelledby="cons---developers-burden-on-synchronization"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cons - developer’s burden on synchronization. </h3> <p>Unlike processes, the OS does not provide complete isolation for threads. This is because all threads in a process use the same shared resources, if one crashes or corrupted, the others will be affected. Therefore, developers must implement synchronization techniques.</p> <h2 id="example-of-multi-threading"> <a href="#example-of-multi-threading" class="anchor-heading" aria-labelledby="example-of-multi-threading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example of Multi-Threading </h2> <p>Here are naive examples in Python and C++.</p> <h3 id="multi-threading-in-python"> <a href="#multi-threading-in-python" class="anchor-heading" aria-labelledby="multi-threading-in-python"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Multi-Threading in Python </h3> <p>When you use multi-threading in Python, you need to know about <code class="language-plaintext highlighter-rouge">Global Interpret Lock (GIL)</code></p> <blockquote> <p><strong>Note - GIL</strong> <br /> In CPython, the Global Interpreter Lock (GIL) is a mutex that ensures only one thread executes Python bytecode at a time. This design simplifies memory management and prevents race conditions, but it also means that multi-threaded Python programs may not fully utilize multi-core processors for CPU-bound tasks. However, for I/O-bound operations, threading can still be effective. (ref: realpython.com)</p> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>

<span class="k">def</span> <span class="nf">run_sub_thread</span><span class="p">(</span><span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">sleep_time</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">sub_thread_name</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">current_thread</span><span class="p">().</span><span class="n">name</span>
    <span class="k">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">sub_thread_name</span><span class="si">}</span><span class="s"> in PID(</span><span class="si">{</span><span class="n">os</span><span class="p">.</span><span class="n">getpid</span><span class="p">()</span><span class="si">}</span><span class="s">) "</span>
        <span class="sa">f</span><span class="s">"is doing </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s"> work"</span>
    <span class="p">)</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">display_threads</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"================"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Active threads : </span><span class="si">{</span><span class="n">threading</span><span class="p">.</span><span class="n">active_count</span><span class="p">()</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">thread_</span> <span class="ow">in</span> <span class="n">threading</span><span class="p">.</span><span class="nb">enumerate</span><span class="p">():</span>
        <span class="k">print</span><span class="p">(</span><span class="n">thread_</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span>
    <span class="n">num_threads</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">sleep_time</span>  <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>    
<span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">display_threads</span><span class="p">()</span>

    <span class="n">threads</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Thread</span><span class="p">(</span>
            <span class="n">target</span><span class="o">=</span><span class="n">run_sub_thread</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">sleep_time</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_threads</span><span class="p">)</span>
    <span class="p">]</span>
    
    <span class="k">for</span> <span class="n">thread_</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
        <span class="n">thread_</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>

    <span class="n">display_threads</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">thread_</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
        <span class="n">thread_</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>

    <span class="n">display_threads</span><span class="p">()</span> <span class="c1"># to check only one thread is available now
</span>
<span class="k">if</span> <span class="s">"__main__"</span> <span class="o">==</span> <span class="n">__name__</span><span class="p">:</span>
    <span class="n">num_threads</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">main</span><span class="p">(</span><span class="n">num_threads</span><span class="p">)</span>
</code></pre></div></div> <h3 id="multi-threading-in-c"> <a href="#multi-threading-in-c" class="anchor-heading" aria-labelledby="multi-threading-in-c"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Multi-Threading in C++ </h3> <p>Here’s a naive implementation of threading in C++.</p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;chrono&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;thread&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
</span><span class="c1">// #include &lt;mutex&gt; // Uncomment to synchronize output</span>

<span class="kt">void</span> <span class="nf">threadJob</span><span class="p">(</span><span class="kt">int</span> <span class="n">idx</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sleepSeconds</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">pid_t</span> <span class="n">threadPID</span> <span class="o">=</span> <span class="n">getpid</span><span class="p">();</span>
    <span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="o">::</span><span class="n">id</span> <span class="n">threadID</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">this_thread</span><span class="o">::</span><span class="n">get_id</span><span class="p">();</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">threadID</span> <span class="o">&lt;&lt;</span> <span class="s">" in PID ("</span> <span class="o">&lt;&lt;</span> <span class="n">threadPID</span> <span class="o">&lt;&lt;</span> <span class="s">")"</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">this_thread</span><span class="o">::</span><span class="n">sleep_for</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">seconds</span><span class="p">(</span><span class="n">sleepSeconds</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">NUM_THREAD</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">SLEEP_SECONDS</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="kr">thread</span> <span class="n">threads</span><span class="p">[</span><span class="n">NUM_THREAD</span><span class="p">];</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NUM_THREAD</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">threads</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="p">(</span><span class="n">threadJob</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">SLEEP_SECONDS</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NUM_THREAD</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">threads</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">join</span><span class="p">();</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div> <p>The above C++ code, system print call won’t work properly because of absence of locks - Race condition</p> <p>About this C++ issue and GIL of Python, we will cover later post.</p> </main> <hr> <footer> <p><a href="#top" id="back-to-top">Back to top</a></p> <div class="d-flex mt-2"> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> <script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script> <script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script> </body> </html>
